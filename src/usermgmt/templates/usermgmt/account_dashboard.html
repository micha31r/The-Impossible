{% extends 'base.html' %}
{% load static %}
{% load tags %}

{% block title %}
	<title>{{ user.username }} - The Impossible</title>
{% endblock %}

{% block nav_custom %}
	<li class="nav-item">
		<a class="nav-link" href="{% url 'idea_explore_page' week_num=date.week page_num=1 %}">Explore</a>
	</li>
	<li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Account
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
        	<a class="dropdown-item" href="#">Notification</a>
			<a class="dropdown-item" href="#">People</a>
			<a class="dropdown-item" href="{% url 'account_dashboard_page' username=user.username content_filter='my' page_num=1 %}">My Ideas</a>
			<a class="dropdown-item" href="{% url 'account_dashboard_page' username=user.username content_filter='liked' page_num=1 %}">Liked Ideas</a>
			<a class="dropdown-item" href="{% url 'account_dashboard_page' username=user.username content_filter='starred' page_num=1 %}">Starred Ideas</a>
			<div class="dropdown-divider"></div>
			<a class="dropdown-item" href="#">Settings</a>
        </div>
      </li>
{% endblock %}

{% block content %}
	<link rel="stylesheet" type="text/css" href="{% static 'usermgmt/account_dashboard_page/main.css' %}">

	<script type="text/javascript" src="{% static 'usermgmt/account_dashboard_page/resize.js' %}"></script>

	<div class="wrapper user-info">
		<div class="user-info-container">
			<h1 class="username">@{{ username }}</h1>
			<h5 class="fullname">{{ viewing_profile.user.get_full_name }}</h5>
			<p class="bio">{{ viewing_profile.bio }}</p>
			{% if viewing_profile.website %}
				<a class="website" href="{{ viewing_profile.website }}"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="rgb(252,52,104)" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> {{ viewing_profile.website }}</a>
			{% endif %}
			<p class="joined-timestamp"><img src="{% static 'component/feather_svg/calendar.svg' %}"> Joined {{ viewing_profile.timestamp.date }}</p>
			<p class="daily-limit"><img src="{% static 'component/feather_svg/edit.svg' %}"> Daily Limit {{ viewing_profile.daily_limit }}</p>
			<br>
			<p class="followers">{{ followers.count }} Followers</p>
			<p class="following">{{ viewing_profile.following.count }} Following</p>
			{% if viewing_profile.user == user %}
				<!-- Edit button -->
				<button class="btn btn-dark btn-black bold edit-profile" onclick="window.location.href='#'">Edit Profile</button>
			{% endif %}
		</div>
		<div class="notification-container">
			<h2>Notifications <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#555" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bell"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg></h2>
			{% for notification in viewing_profile.notification.all reversed %}
				<div class="message-wrapper">
					{% if notification.message_status == 1 and viewing_profile.user == user %}
						<h6>{{ notification.message }}</h6>
						<p>{{ notification.get_message_status_display }} Message</p>
					{% else %}
						<h6>{{ notification.message }}</h6>
						<p>{{ notification.get_message_status_display }} Message</p>
					{% endif %}
				</div>
			{% endfor %}
		</div>
	</div>
	<div class="wrapper">
		<div class="header-wrapper">
			<h3 class="header {% if content_filter == 'my' %}header-current{% endif %}"><a href="{% url 'account_dashboard_page' username=username content_filter='my' page_num=1 %}">{% if viewing_profile.user == user %}My{% endif %} Ideas</a></h3>
			<h3 class="header {% if content_filter == 'liked' %}header-current{% endif %}"><a href="{% url 'account_dashboard_page' username=username content_filter='liked' page_num=1 %}">Liked Ideas</a></h3>
			{% if viewing_profile.user == user %}
				<h3 class="header {% if content_filter == 'starred' %}header-current{% endif %}"><a href="{% url 'account_dashboard_page' username=username content_filter='starred' page_num=1 %}">Starred Ideas</a></h3>
			{% endif %}
		</div>
		{% include 'idea/masonary.html' %}

		<!-- Page selector -->
		<div class="page-link-wrapper">
			<!-- Previous page link -->
			<a {% if page_num|add:'-1' > 0 %} href="{% url 'account_dashboard_page' username=user.username content_filter=content_filter page_num=page_num|add:'-1' %}" {% endif %} class="{% if page_num|add:'-1' > 0 %} change-page {% else %} change-page-unavailable {% endif %}">
				<svg class="left-arrow" width="27" height="41" viewBox="0 0 27 41" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path fill-rule="evenodd" clip-rule="evenodd" d="M26 5.99999L5.99999 26L0.34314 20.3431L20.3431 0.34314L26 5.99999Z"/>
				<path fill-rule="evenodd" clip-rule="evenodd" d="M21 41L0.999991 21L6.65685 15.3431L26.6568 35.3431L21 41Z"/>
				</svg>
			</a>

			<!-- Link omission (...) -->
			{% if page_num|add:'-3' > 0 %}
				<p class="word-omission">..</p>
			{% endif %}

			<!-- All page links -->
			{% for i in max_page|times %}
				<!-- Only show a maximum of 5 page links -->
				{% if i|add:1 < page_num|add:3 and i|add:1 > page_num|add:'-3' %}
					<a class="{% if i|add:1 == page_num %} current-page-link {% else %} page-link {% endif %}" href="{% url 'account_dashboard_page' username=user.username content_filter=content_filter page_num=i|add:1 %}"><b>{{ i|add:1 }}</b></a>
				{% endif %}
			{% endfor %}

			<!-- Link omission (...) -->
			{% if page_num|add:3 < max_page|add:1 %}
				<p class="word-omission">..</p>
			{% endif %}

			<!-- Next page link -->
			<a {% if page_num|add:1 <= max_page %} href="{% url 'account_dashboard_page' username=user.username content_filter=content_filter page_num=page_num|add:1 %}" {% endif %} class="{% if page_num|add:1 <= max_page %} change-page {% else %} change-page-unavailable {% endif %}">
				<svg class="right-arrow" width="27" height="41" viewBox="0 0 27 41" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path fill-rule="evenodd" clip-rule="evenodd" d="M1.00001 5.99999L21 26L26.6569 20.3431L6.65686 0.34314L1.00001 5.99999Z"/>
				<path fill-rule="evenodd" clip-rule="evenodd" d="M6.00001 41L26 21L20.3432 15.3431L0.343155 35.3431L6.00001 41Z"/>
				</svg>
			</a>
		</div>
	</div>
{% endblock %}