{% extends 'base.html' %}
{% load static %}
{% load tags %}

{% block title %}
	<title>{{ idea.name }} - The Impossible</title>
{% endblock %}

{% block content %}
	<!-- Main css -->
	<link rel="stylesheet" type="text/css" href="{% static 'idea/detail_page/main.css' %}">

	<div class="wrapper">
		<!-- Content -->
		<h2>{{ idea.name }}</h2>
		<h5>{{ idea.short_description }}</h5>
		<h5>By {{ idea.author }}</h5>
		<p>{{ idea.full_description }}</p>
		
		<!-- Like button and view count -->
		{% include 'idea/mini_card_action.html' %}	

		{% if user == idea.author.user %}
			<button class="btn btn-black-outline bold edit" onclick="window.location.href='{% url 'idea_edit_page' pk=idea.id %}'">Edit</button>
		{% endif %}

		<!-- Timestamp -->
		<div class="timestamp">
			<p>Created at <span class="time">{{ idea.timestamp }}</span></p>
			<p>Last Edited <span class="time">{{ idea.last_edit }}</span></p>
		</div>

		<hr class="section-seperator">

		<form method="post" enctype="multipart/form-data">
			{% csrf_token %}

			<!-- Show errors -->
			{% if error %}
				<div class="alert alert-black bold" role="alert">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-triangle"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
	                {{ error|escape }}
	            </div>
			{% endif %}

			{% include 'form_error.html' %}

			{{ form.full_description }}
				
			<button class="btn btn-dark btn-black bold submit" type="submit">Post Comment</button>
		</form>

		<div class="comment-container">
			{% for comment in idea.comments.all reversed %}
				<div class="comment-wrapper">
					<h5>{{ comment.full_description }}</h5>
					<p>{{ comment.author }}</p>
					<p>Last Edited <span class="time">{{ comment.last_edit }}</span></p>
				</div>
			{% endfor %}
			{% if idea.comments.all|length == 0 %}
				<p>No comments</p>
			{% endif %}
		</div>
	</div>
{% endblock %}